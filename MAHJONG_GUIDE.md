# 麻将记录模块使用指南

## 📖 功能介绍

麻将记录模块帮助您记录和分析麻将战绩，包括：
- 🎲 记录每局麻将的详细信息（日期、时间、玩家、分数等）
- 💰 追踪盈亏情况
- 📊 查看胜率、场次等统计数据
- 📈 分析不同游戏类型的表现
- 📅 月度和每日趋势分析

## 🚀 快速开始

### 1. 初始化麻将记录表

首次使用前，需要初始化数据库表：

```bash
npm run init-mahjong
```

### 2. 重启后端服务器

初始化完成后，重启后端服务器：

```bash
# 停止当前运行的服务器（Ctrl+C）
# 然后重新启动
npm start
# 或开发模式
npm run dev
```

### 3. 访问麻将模块

在前端应用中，您会看到两个新的菜单项：
- 🀄 **麻将记录**：管理麻将战绩
- 🎲 **麻将统计**：查看统计分析

## 📝 添加麻将记录

### 步骤

1. 点击侧边栏的 **"麻将记录"**
2. 点击右上角的 **"➕ 添加记录"** 按钮
3. 填写记录信息：

### 必填字段

- **游戏日期** *：选择游戏日期
- **玩家和分数** *：
  - 至少需要 2 个玩家
  - 为每个玩家输入姓名和分数
  - 可以点击 "➕ 添加玩家" 增加更多玩家
  - 可以点击 ❌ 删除玩家（至少保留 2 个）
- **盈亏金额** *：输入您的盈亏
  - 正数表示赢钱（如：+100）
  - 负数表示输钱（如：-50）

### 可选字段

- **游戏时间**：记录具体时间
- **游戏类型**：如 "血战"、"血流"、"二五八万" 等
- **地点**：游戏地点
- **备注**：其他说明信息

### 示例

```
游戏日期: 2025-12-02
游戏时间: 14:30
游戏类型: 血战
地点: 小王家

玩家和分数:
- 张三: 150
- 李四: -50
- 王五: -30
- 我: -70

盈亏金额: -70
备注: 手气不好
```

## 🔍 筛选和查询记录

在麻将记录页面，您可以使用多种方式筛选：

1. **日期范围**：
   - 开始日期：选择起始日期
   - 结束日期：选择结束日期

2. **游戏类型**：
   - 输入游戏类型名称（如：血战）
   - 留空显示所有类型

3. **结果筛选**：
   - 全部：显示所有记录
   - 赢：只显示盈利的记录
   - 输：只显示亏损的记录

4. **重置筛选**：
   - 点击 "重置筛选" 清除所有筛选条件

## ✏️ 编辑和删除记录

### 编辑记录
1. 在记录列表中找到要编辑的记录
2. 点击 **"编辑"** 按钮
3. 修改信息后点击 **"更新"**

### 删除记录
1. 在记录列表中找到要删除的记录
2. 点击 **"删除"** 按钮
3. 确认删除操作

## 📊 查看统计分析

点击侧边栏的 **"麻将统计"** 查看详细统计。

### 统计卡片

顶部显示四个统计卡片：

1. **总场次**
   - 本月总游戏场次
   - 胜场和负场数量

2. **胜率**
   - 胜率百分比
   - 胜场/总场次

3. **盈亏**
   - 本月总盈亏
   - 均场盈亏

4. **单局最佳/最差**
   - 单局最高盈利
   - 单局最大亏损

### 游戏类型统计

显示每种游戏类型的：
- 场次数量
- 胜率
- 总盈亏
- 均场盈亏

### 每日趋势

以柱状图形式显示：
- 每天的盈亏情况
- 绿色：盈利
- 红色：亏损
- 高度：金额大小

### 月度统计表

表格形式显示每月的：
- 总场次
- 胜场/负场
- 胜率
- 总盈亏
- 均场盈亏

## 💡 使用技巧

### 1. 规范命名

建议使用统一的游戏类型命名，便于统计分析：
- ✅ 推荐：血战、血流、二五八万
- ❌ 不推荐：血战麻将、血战到底、xz

### 2. 及时记录

游戏结束后立即记录，确保数据准确性。

### 3. 详细备注

在备注中记录：
- 特殊牌局情况
- 当日手气状态
- 需要改进的地方

### 4. 定期分析

建议每周或每月查看统计数据：
- 分析胜率变化趋势
- 找出盈利/亏损的游戏类型
- 调整游戏策略

## 🔒 数据安全

- ✅ 所有记录与您的账户绑定
- ✅ 其他用户无法看到您的数据
- ✅ 数据存储在本地数据库
- ✅ 建议定期备份 `database/accounting.db` 文件

## ❓ 常见问题

### Q: 如何计算盈亏金额？

A: 盈亏金额是您个人的输赢金额：
- 如果您赢了 100 元，输入 `100` 或 `+100`
- 如果您输了 50 元，输入 `-50`

### Q: 玩家分数有什么用？

A: 玩家分数用于记录完整的牌局信息，便于：
- 回顾牌局
- 验证计分是否正确
- 统计各玩家的表现（未来功能）

### Q: 可以导出数据吗？

A: 当前版本暂不支持导出，但数据都存储在 `database/accounting.db` 文件中，您可以：
- 直接复制该文件备份
- 使用 SQLite 工具查看和导出

### Q: 统计分析显示不准确怎么办？

A: 请检查：
1. 筛选条件是否正确（特别是月份选择）
2. 记录的日期是否正确
3. 尝试刷新页面
4. 检查是否有重复记录

### Q: 如何删除所有麻将记录？

A: 可以通过以下方式：
1. 逐条删除（在麻将记录页面）
2. 直接删除数据库表（需要重新运行 `npm run init-mahjong`）

## 📞 技术支持

如遇到问题，请检查：
1. 后端服务器是否正常运行
2. 浏览器控制台是否有错误信息
3. 数据库表是否正确初始化

---

**祝您游戏愉快，战绩长虹！** 🀄🎲

